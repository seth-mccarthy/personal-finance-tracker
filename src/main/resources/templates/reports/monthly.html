<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Reports - Finance Tracker</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        h1, h2 { color: #333; }
        .nav { background: #667eea; padding: 15px; margin-bottom: 20px; border-radius: 8px; }
        .nav a { color: white; text-decoration: none; margin-right: 20px; }
        .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 20px; }
        .stat { padding: 20px; border-radius: 8px; color: white; }
        .stat-blue { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }
        .stat-red { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        .stat-green { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .stat-orange { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .btn { padding: 10px 20px; background: #667eea; color: white; text-decoration: none; border-radius: 6px; border: none; cursor: pointer; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input { padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        .progress-bar { background: #e5e7eb; border-radius: 10px; height: 20px; overflow: hidden; margin: 10px 0; }
        .progress-fill { height: 100%; transition: width 0.3s; }
    </style>
</head>
<body>
    <div class="nav">
        <a href="/">Dashboard</a>
        <a href="/transactions">Transactions</a>
        <a href="/budgets">Budgets</a>
        <a href="/categories">Categories</a>
        <a href="/reports">Reports</a>
    </div>
    
    <h1>Monthly Report</h1>
    
    <div class="card">
        <form method="get" action="/reports" style="display:flex;gap:15px;align-items:flex-end;">
            <div class="form-group" style="margin:0;flex:1;">
                <label for="period">Period (YYYY-MM)</label>
                <input type="month" id="period" name="period" th:value="${currentPeriod}">
            </div>
            <button type="submit" class="btn">Generate Report</button>
        </form>
    </div>
    
    <div class="stats">
        <div class="stat stat-blue">
            <h3 style="font-size:14px;opacity:0.9;">Total Income</h3>
            <p style="font-size:32px;font-weight:bold;margin:10px 0;" th:text="'$' + ${report.totalIncome}">$0.00</p>
        </div>
        
        <div class="stat stat-red">
            <h3 style="font-size:14px;opacity:0.9;">Total Expenses</h3>
            <p style="font-size:32px;font-weight:bold;margin:10px 0;" th:text="'$' + ${report.totalExpenses}">$0.00</p>
        </div>
        
        <div class="stat" th:classappend="${report.netSavings >= 0 ? 'stat-green' : 'stat-orange'}">
            <h3 style="font-size:14px;opacity:0.9;">Net Savings</h3>
            <p style="font-size:32px;font-weight:bold;margin:10px 0;" th:text="'$' + ${report.netSavings}">$0.00</p>
        </div>
    </div>
    
    <div class="card">
        <h2>Spending by Category</h2>
        
        <div th:if="${#lists.isEmpty(report.categoryBreakdown)}" style="text-align:center;padding:40px;color:#6b7280;">
            <p>No expenses recorded for this period.</p>
        </div>
        
        <div th:unless="${#lists.isEmpty(report.categoryBreakdown)}">
            <div th:each="cat : ${report.categoryBreakdown}" style="margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid #e5e7eb;">
                <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                    <div>
                        <h3 style="font-size:18px;margin:0;" th:text="${cat.categoryName}">Category</h3>
                        <p style="color:#6b7280;margin:5px 0;" th:text="${#numbers.formatDecimal(cat.percentage, 1, 1)} + '% of total'">0%</p>
                    </div>
                    <p style="font-size:22px;font-weight:bold;color:#ef4444;margin:0;" th:text="'$' + ${cat.amount}">$0.00</p>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" 
                         th:style="'width:' + ${cat.percentage} + '%;background:' + ${cat.colorCode ?: '#667eea'}"></div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>