<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Transactions - Finance Tracker</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        h1 { color: #333; }
        .nav { background: #667eea; padding: 15px; margin-bottom: 20px; border-radius: 8px; }
        .nav a { color: white; text-decoration: none; margin-right: 20px; }
        .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .btn { padding: 10px 20px; background: #667eea; color: white; text-decoration: none; border-radius: 6px; display: inline-block; border: none; cursor: pointer; font-size: 14px; }
        .btn-danger { background: #ef4444; }
        .btn-secondary { background: #6b7280; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background: #f9f9f9; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input { padding: 8px; border: 1px solid #ddd; border-radius: 4px; width: 100%; }
        .alert { padding: 15px; margin: 15px 0; border-radius: 6px; }
        .alert-success { background: #d1fae5; color: #065f46; }
        .badge { padding: 4px 10px; border-radius: 12px; font-size: 12px; }
        .badge-income { background: #d1fae5; color: #065f46; }
        .badge-expense { background: #fee2e2; color: #991b1b; }
    </style>
</head>
<body>
    <div class="nav">
        <a href="/">Dashboard</a>
        <a href="/transactions">Transactions</a>
        <a href="/budgets">Budgets</a>
        <a href="/categories">Categories</a>
        <a href="/reports">Reports</a>
    </div>
    
    <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
    
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
        <h1>Transactions</h1>
        <a href="/transactions/new" class="btn">+ Add Transaction</a>
    </div>
    
    <div class="card">
        <form method="get" action="/transactions" style="display:grid;grid-template-columns:1fr 1fr auto;gap:15px;">
            <div class="form-group" style="margin:0;">
                <label for="startDate">Start Date</label>
                <input type="date" id="startDate" name="startDate" th:value="${startDate}">
            </div>
            <div class="form-group" style="margin:0;">
                <label for="endDate">End Date</label>
                <input type="date" id="endDate" name="endDate" th:value="${endDate}">
            </div>
            <button type="submit" class="btn" style="margin-top:28px;">Filter</button>
        </form>
    </div>
    
    <div class="card">
        <div th:if="${#lists.isEmpty(transactions)}" style="text-align:center;padding:40px;color:#6b7280;">
            <p>No transactions found for this date range.</p>
        </div>
        
        <table th:unless="${#lists.isEmpty(transactions)}">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Description</th>
                    <th>Category</th>
                    <th>Type</th>
                    <th style="text-align:right;">Amount</th>
                    <th style="text-align:center;">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="t : ${transactions}">
                    <td th:text="${#temporals.format(t.transactionDate, 'MMM dd, yyyy')}">Date</td>
                    <td th:text="${t.description ?: 'N/A'}">Description</td>
                    <td th:text="${t.category.name}">Category</td>
                    <td>
                        <span class="badge" th:classappend="${t.type.name() == 'INCOME' ? 'badge-income' : 'badge-expense'}" 
                              th:text="${t.type}">Type</span>
                    </td>
                    <td style="text-align:right;font-weight:bold;" 
                        th:style="'text-align:right;font-weight:bold;color:' + (${t.type.name() == 'INCOME'} ? '#10b981' : '#ef4444')"
                        th:text="'$' + ${t.amount}">$0.00</td>
                    <td style="text-align:center;">
                        <a th:href="@{/transactions/{id}/edit(id=${t.id})}" class="btn btn-secondary" style="padding:6px 12px;margin-right:5px;">Edit</a>
                        <form th:action="@{/transactions/{id}/delete(id=${t.id})}" method="post" style="display:inline;">
                            <button type="submit" class="btn btn-danger" style="padding:6px 12px;" 
                                    onclick="return confirm('Delete this transaction?')">Delete</button>
                        </form>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</body>
</html>